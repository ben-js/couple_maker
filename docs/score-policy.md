# 📊 우선순위 측정 점수 정책

## 🎯 개요
사용자가 작성한 이상형에 맞는 AI 매칭을 위한 Score 알고리즘 정책입니다.

## 🔄 매칭 플로우

### 1. 회원가입 단계
- **회원가입 시**: `users` 테이블에 `has_score: false`로 설정
- **프로필 작성 후**: `has_profile: true`로 업데이트
- **이상형 작성 후**: `has_preferences: true`로 업데이트

### 2. 점수 작성 단계
- **관리자 확인**: Admin 시스템의 회원 관리 페이지에서 `has_score: false`인 고객 확인
- **점수 작성**: 매니저가 고객의 프로필과 사진을 보고 `Scores` 테이블에 점수 작성
- **점수 완료**: `has_score: true`로 업데이트

### 3. 매칭 단계
- **소개팅 신청**: `MatchingRequests`의 `status`가 `waiting`인 유저
- **매칭 추천**: 매칭 알고리즘으로 어울리는 고객 10명 추천
- **매니저 검토**: 추천받은 고객의 점수(radar chart), 프로필, 이상형 확인
- **매칭 승인**: 매니저가 적절한 대상자 선택 후 매칭 승인

## 📈 점수 알고리즘

### 🎨 외모 점수 (100점 만점)
**구성 요소:**
- **얼굴**: 50% (매니저 직접 평가)
- **키**: 20% (성별별 기준)
- **바디타입**: 15% (체형별 기준)
- **나이**: 15% (성별별 기준)

#### 키 점수 기준
**남성 기준:**
- 183~192cm: 100점
- 178~182cm 또는 193~200cm: 90점
- 173~177cm: 80점
- 165~172cm: 70점
- 155~164cm: 60점
- 155cm 미만: 55점

**참고**: 182~193cm 구간은 각각 90점 구간에 포함됨

**여성 기준:**
- 165~168cm: 100점
- 162~164cm 또는 169~172cm: 90점
- 158~161cm 또는 173~175cm: 80점
- 155~157cm 또는 176cm 이상: 70점
- 154cm 미만: 55점

#### 바디타입 점수 기준
- **모델핏**: 100점
- **운동하는체형**: 90점
- **보통/마른**: 85점
- **귀엽고통통한**: 70점
- **통통한편**: 60점
- **포근한체형**: 50점

#### 나이 점수 기준
**계산 기준**: 매칭 신청 시점의 만나이

**남성 기준:**
- 28~31세: 100점
- 25~27세 또는 32~35세: 90점
- 36~38세: 80점
- 25세 미만 또는 39~42세: 70점
- 43세 이상: 60점

**여성 기준:**
- 23~26세: 100점
- 22세 미만 또는 27~29세: 90점
- 30~32세: 80점
- 33~35세: 70점
- 36~39세: 60점
- 40세 이상: 20점

### 😊 성격 점수 (100점 만점)
**구성 요소:**
- **이상형 우선순위**: 10%
- **흡연 유무**: 20%
- **취미**: 35%
- **자녀희망**: 15%
- **MBTI**: 20%

#### 이상형 우선순위 점수
**성격 우선순위:**
- 1순위: 100점
- 2순위: 90점
- 3순위: 80점
- 4순위: 70점
- 5순위: 60점
- 6순위: 50점

**가치관 우선순위:**
- 1순위: 100점
- 2순위: 90점
- 3순위: 80점
- 4순위: 70점
- 5순위: 60점
- 6순위: 50점

**계산 기준**: 
- **기본 가중치**: 성격과 가치관의 가중치는 각각 70%와 30%로 고정
- **사용자 설정**: 사용자가 우선순위 비율을 직접 설정한 경우 해당 비율 적용
- **우선순위**: 사용자 설정이 있는 경우 사용자 설정 우선, 없으면 기본 가중치 적용

**계산 예시:**
성격 1순위 + 가치관 2순위인 경우 (고정 가중치):
- 성격 점수: 100점 × 70% = 70점
- 가치관 점수: 90점 × 30% = 27점
- **총점**: 70점 + 27점 = 97점

#### 흡연 점수
- **비흡연**: 100점
- **흡연**: 50점

#### 취미 점수
**평가 기준**: 가장 높은 점수의 취미 1개만 적용

- **봉사활동**: 100점
- **자기계발/독서/산책** (봉사활동 제외): 90점
- **게임** (봉사활동 제외): 50점
- **기타**: 80점

#### 자녀희망 점수
- **자녀 희망**: 100점
- **딩크족 희망**: 70점

#### MBTI 점수
- **ENFJ**: 100점
- **INFJ**: 95점
- **ESFJ**: 90점
- **ENTP/ENTJ/INTJ**: 70점
- **ISTP/ESTP**: 60점
- **기타**: 80점

### 💼 직업 점수 (100점 만점)
**구성 요소:**
- **직업**: 50%
- **연봉**: 30%
- **직장**: 20% (추후 Company DB 활용 예정)

#### 직업 점수 기준
- **판사/검사**: 100점
- **변호사/의사/교수**: 95점
- **공기업/교사/연예인**: 90점
- **회사원/간호사/운동선수/예술가/작가/미용사**: 80점
- **학생/자영업/요리사**: 70점
- **기타**: 60점

#### 연봉 점수 기준
- **2억원 이상**: 100점
- **1억5천만원~2억원**: 90점
- **7천만원~9천만원**: 85점
- **5천만원~7천만원**: 80점
- **4천만원~5천만원**: 70점
- **4천만원 미만**: 60점

### 🎓 학력 점수 (100점 만점)
- **박사**: 100점
- **대학원**: 90점
- **대학교**: 80점
- **전문대**: 70점
- **고등학교**: 50점

### 💰 경제력 점수 (100점 만점)
**구성 요소:**
- **자산**: 70%
- **직업**: 20%
- **연봉**: 10%

#### 자산 점수 기준
- **20억원 이상**: 100점
- **15억원~20억원**: 95점
- **10억원~15억원**: 90점
- **5억원~10억원**: 85점
- **3억원~5억원**: 80점
- **2억원~3억원**: 75점
- **1억원~2억원**: 75점
- **5천만원~1억원**: 60점
- **5천만원 미만**: 20점

#### 직업 점수 기준
- **판사/검사/변호사/의사**: 100점
- **공기업/교사/교수**: 90점
- **학생**: 60점
- **기타**: 80점

#### 연봉 점수 기준
- **2억원 이상**: 100점
- **1억5천만원~2억원**: 90점
- **7천만원~9천만원**: 85점
- **5천만원~7천만원**: 80점
- **4천만원~5천만원**: 70점
- **4천만원 미만**: 60점

## 🏆 등급 기준

### 점수별 등급 분류
- **S 등급**: 95점 이상
- **A 등급**: 85~94점
- **B 등급**: 75~84점
- **C 등급**: 65~74점
- **D 등급**: 55~64점
- **E 등급**: 45~54점
- **F 등급**: 45점 미만

## 🧮 최종 점수 계산 공식

### 개인 점수 계산
```
개인_총점 = (외모점수 × 0.25) + (성격점수 × 0.25) + (직업점수 × 0.2) + (학력점수 × 0.15) + (경제력점수 × 0.15)
```

## 🔄 점수 조정 시스템

### 리뷰 기반 조정
`Reviews` 테이블의 다음 데이터로 매니저 또는 AI가 점수 조정 가능:
- **tags**: 리뷰 태그
- **rating.honesty**: 솔직함 점수
- **rating.manners**: 매너 점수
- **comment**: 리뷰 코멘트
- **first_impression_vs_reality**: 첫인상 vs 현실 비교

### 점수 조정 방법
- **리뷰 점수**: `(honesty + manners) / 2`
- **조정 범위**: ±10점 이내
- **조정 사유**: 필수 입력 (리뷰 내용 기반)
- **조정 권한**: 매니저 또는 AI (자동 조정)
- **조정 이력**: 모든 조정 내역 기록 및 추적

## 🗄️ 테이블 구조

### Scores 테이블 구조

#### 테이블 스키마
```javascript
{
  TableName: 'Scores',
  KeySchema: [
    { AttributeName: 'user_id', KeyType: 'HASH' }  // Primary Key
  ],
  AttributeDefinitions: [
    { AttributeName: 'user_id', AttributeType: 'S' }
  ]
}
```

### 데이터 구조
```javascript
{
  user_id: 'user_123',           // 사용자 ID
  scorer: 'manager_1',           // 점수 작성한 매니저
  summary: '외모적 능력이 뛰어남', // 총평
  average: 83,                   // 총점 (100점 만점)
  appearance: 'S',               // 외모 등급 (S/A/B/C/D/E/F)
  personality: 'A',              // 성격 등급
  job: 'B',                      // 직업 등급
  education: 'C',                // 학력 등급
  economics: 'D',                // 경제력 등급
  created_at: '2024-12-01T00:00:00Z',
  updated_at: '2024-12-01T00:00:00Z'
}
```

### 점수 산정 예시
- (예시)
  - 외모: 90점, 성격: 80점, 직업: 85점, 학력: 80점, 경제력: 70점
  - 개인 평균점수 = (90×0.25)+(80×0.25)+(85×0.2)+(80×0.15)+(70×0.15) = 22.5+20+17+12+10.5 = 82점 → B등급